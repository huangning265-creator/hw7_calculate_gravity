<!doctype html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>重力測站計算（理論重力 / 自由空氣 / Bouguer）</title>
  <style>
    body{font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Noto Sans TC', 'PingFang TC', 'Microsoft JhengHei', sans-serif; line-height:1.6; padding:28px; max-width:980px; margin:0 auto; color:#111}
    h1,h2{color:#0b5ed7}
    pre{background:#f7f7fb;border:1px solid #e6e7ee;padding:14px;overflow:auto;border-radius:8px}
    code{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, 'Roboto Mono', 'Noto Sans Mono', monospace}
    .meta{background:#f1f8ff;border-left:4px solid #0b5ed7;padding:10px;border-radius:6px;margin-bottom:12px}
    .btn{display:inline-block;background:#0b5ed7;color:#fff;padding:8px 12px;border-radius:6px;text-decoration:none;border:none;cursor:pointer}
    .grid{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    @media(max-width:720px){.grid{grid-template-columns:1fr}}
  </style>
</head>
<body>
  <h1>重力測站計算報告（HTML）</h1>
  <div class="meta">
    <strong>輸入資料</strong><br>
    緯度：48.1195° N<br>
    經度：12.1878° E（本題中無直接使用）<br>
    高程（站高）：487.9 m<br>
    觀測重力：980,717.39 mGal
  </div>

  <h2>題目簡述（中文）</h2>
  <p>請計算下列項目：<br>
  (a) i) 理論重力； ii) 自由空氣修正（Free-air correction）； iii) Bouguer 修正； iv) 自由空氣重力異常； v) Bouguer 重力異常。<br>
  (b) 若測站位於海面（在該點下方水深等於 487.9 m），在相同緯度與相同觀測重力下，重新計算自由空氣異常與 Bouguer 異常（考慮海水密度）。</p>

  <h2>採用公式與預設常數</h2>
  <div class="grid">
    <div>
      <strong>理論重力（採用）：</strong><br>
      國際常用多項式近似：
      <pre><code>g(φ)=978031.851 mGal * (1 + 0.005278895*sin²φ + 0.000023462*sin⁴φ)</code></pre>
    </div>
    <div>
      <strong>修正與常數</strong>
      <ul>
        <li>自由空氣修正（FAC）係數：0.3086 mGal/m</li>
        <li>Bouguer 修正常用係數（簡化）：0.04193 × ρ × h（單位 mGal；ρ 為密度 kg/m³）</li>
        <li>預設岩石密度 ρ_rock = 2670 kg/m³；海水密度 ρ_water = 1025 kg/m³</li>
      </ul>
    </div>
  </div>

  <h2>說明（計算流程）</h2>
  <ol>
    <li>計算理論重力 g_theoretical（海平面值，與緯度有關）</li>
    <li>計算自由空氣修正 FAC = 0.3086 × h（mGal）</li>
    <li>計算簡化 Bouguer 修正：Δg_Bouguer = 0.04193 × ρ × h（mGal）</li>
    <li>自由空氣異常 FA = g_obs − g_theoretical + FAC</li>
    <li>Bouguer 異常 B = g_obs − g_theoretical + FAC − Δg_Bouguer</li>
    <li>海面情況：站高視為 0，Bouguer 修正改為使用 (ρ_rock − ρ_water) × h 對應的質量差</li>
  </ol>

  <h2>Python 程式碼（可複製並執行）</h2>
  <p>按下「複製程式碼」後可貼到你的編輯器執行。</p>
  <button class="btn" id="copyBtn">複製程式碼</button>
  <pre id="pycode"><code>
import math

# ============================
# Input data
# ============================
lat = 48.1195              # degrees
h = 487.9                  # elevation (m)
g_obs = 980717.39          # observed gravity (mGal)

rho_rock = 2670            # kg/m^3
rho_water = 1025           # kg/m^3

# ============================
# 1. Theoretical gravity (mGal)
# International gravity formula
# ============================
phi = math.radians(lat)
g_theoretical = 978031.851 * (1 
                              + 0.005278895 * math.sin(phi)**2
                              + 0.000023462 * math.sin(phi)**4)

# ============================
# 2. Free-air correction (FAC)
# +0.3086 mGal per meter
# ============================
FAC = 0.3086 * h

# ============================
# 3. Bouguer correction
# Δg_B = 0.04193 * rho * h   (mGal)
# ============================
Bouguer_corr = 0.04193 * rho_rock * h / 1000  # convert μGal to mGal

# ============================
# 4. Free-air anomaly
# Δg_FA = g_obs - g_theoretical + FAC
# ============================
FA_anomaly = g_obs - g_theoretical + FAC

# ============================
# 5. Bouguer anomaly
# Δg_B = g_obs - g_theoretical + FAC - Bouguer_corr
# ============================
Bouguer_anomaly = g_obs - g_theoretical + FAC - Bouguer_corr

# ============================
# Part (b): Station located at sea surface,
# over water depth equal to 487.9 m
# ============================

# Free-air anomaly is same formula (h = 0 at sea surface!)
FA_anomaly_sea = g_obs - g_theoretical  # no freeair term because h=0

# Water Bouguer correction:
# Use density difference: (rho_rock - rho_water)
B_corr_water = 0.04193 * (rho_rock - rho_water) * h / 1000

Bouguer_anomaly_sea = g_obs - g_theoretical - B_corr_water

# ============================
# Print results
# ============================
print("\n=== Results (Part a) ===")
print(f"Theoretical gravity:       {g_theoretical:.2f} mGal")
print(f"Free-air correction (FAC): {FAC:.2f} mGal")
print(f"Bouguer correction:        {Bouguer_corr:.2f} mGal")
print(f"Free-air anomaly:          {FA_anomaly:.2f} mGal")
print(f"Bouguer anomaly:           {Bouguer_anomaly:.2f} mGal")

print("\n=== Results (Part b: Ocean Surface) ===")
print(f"Free-air anomaly (sea):    {FA_anomaly_sea:.2f} mGal")
print(f"Bouguer anomaly (sea):     {Bouguer_anomaly_sea:.2f} mGal")
  </code></pre>

  <h2>如何使用</h2>
  <ol>
    <li>將上方程式複製到本機 Python 檔案（例如 <code>gravity_calc.py</code>），或在 Jupyter/Colab 上執行。</li>
    <li>執行後會在終端顯示理論重力、各修正與異常值。</li>
    <li>若要改密度、緯度或站高，請修改開頭的變數。</li>
  </ol>

  <script>
    const copyBtn = document.getElementById('copyBtn');
    const pycode = document.getElementById('pycode').innerText;
    copyBtn.addEventListener('click', async () => {
      try {
        await navigator.clipboard.writeText(pycode);
        copyBtn.innerText = '已複製 ✓';
        setTimeout(()=> copyBtn.innerText = '複製程式碼', 2000);
      } catch (e) {
        alert('瀏覽器不支援自動複製，請手動選取並複製。');
      }
    });
  </script>
</body>
</html>
